<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Your Resume</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #e9ecef; }
        .card { border: none; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .card-header { background-color: #0d6efd; color: white; font-weight: 600; }
        .btn-add {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 1.2rem;
            line-height: 1;
        }
        .template-preview {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: inline-block; /* Ensures label behaves like the previous div */
        }
        .template-preview img {
            max-width: 100%;
            border-radius: 5px;
        }
        /* Updated CSS Selector to match new structure */
        .template-preview:hover, input[type="radio"]:checked + label.template-preview {
            border-color: #0d6efd;
            box-shadow: 0 0 15px rgba(13, 110, 253, 0.4);
        }
        .download-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="text-center mb-5">
        <h2>Resume Details</h2>
        <p class="lead">Fill out the form below to create your professional resume.</p>
    </div>

    <form th:action="@{/download}" th:object="${resumeData}" method="post">
        <!-- Template Selection -->
        <div class="card mb-4">
            <div class="card-header">
                Step 1: Choose a Template
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 text-center">
                        <input type="radio" name="template" value="template1.html" class="d-none" id="template1" checked>
                        <label for="template1" class="template-preview">
                            <img src="https://placehold.co/400x566/6a11cb/ffffff?text=Modern" alt="Modern Template">
                            <p class="mt-2 mb-0 fw-bold">Modern</p>
                        </label>
                    </div>
                     <div class="col-md-4 text-center">
                        <input type="radio" name="template" value="template2.html" class="d-none" id="template2">
                        <label for="template2" class="template-preview">
                            <img src="https://placehold.co/400x566/2575fc/ffffff?text=Classic" alt="Classic Template">
                            <p class="mt-2 mb-0 fw-bold">Classic</p>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Personal Details -->
        <div class="card mb-4">
            <div class="card-header">Step 2: Personal Details</div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="fullName" class="form-label">Full Name</label>
                        <input id="fullName" type="text" class="form-control" th:field="*{name}" placeholder="John Doe">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label">Email Address</label>
                        <input id="email" type="email" class="form-control" th:field="*{email}" placeholder="john.doe@example.com">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="phone" class="form-label">Phone Number</label>
                        <input id="phone" type="tel" class="form-control" th:field="*{phone}" placeholder="+1 123-456-7890">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="address" class="form-label">Address</label>
                        <input id="address" type="text" class="form-control" th:field="*{address}" placeholder="City, State">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="linkedin" class="form-label">LinkedIn Profile</label>
                        <input id="linkedin" type="text" class="form-control" th:field="*{linkedin}" placeholder="linkedin.com/in/yourprofile">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="website" class="form-label">Personal Website/Portfolio</label>
                        <input id="website" type="text" class="form-control" th:field="*{website}" placeholder="yourportfolio.com">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Professional Summary -->
        <div class="card mb-4">
            <div class="card-header">Step 3: Professional Summary</div>
            <div class="card-body">
                <label for="summary" class="form-label d-none">Professional Summary</label>
                <textarea id="summary" class="form-control" rows="4" th:field="*{summary}" placeholder="A brief summary of your career and skills..."></textarea>
            </div>
        </div>

        <!-- Work Experience -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>Step 4: Work Experience</span>
                <button type="button" class="btn btn-light btn-add" onclick="addExperience()">+</button>
            </div>
            <div class="card-body" id="experience-container">
                <div th:each="exp, iterStat : *{experiences}" class="experience-entry mb-4 p-3 border rounded">
                     <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label" th:for="|expJobTitle${iterStat.index}|">Job Title</label>
                            <input type="text" class="form-control" th:id="|expJobTitle${iterStat.index}|" th:field="*{experiences[__${iterStat.index}__].jobTitle}" placeholder="Software Engineer">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label" th:for="|expCompany${iterStat.index}|">Company</label>
                            <input type="text" class="form-control" th:id="|expCompany${iterStat.index}|" th:field="*{experiences[__${iterStat.index}__].company}" placeholder="Tech Solutions Inc.">
                        </div>
                         <div class="col-md-12 mb-3">
                             <label class="form-label" th:for="|expDuration${iterStat.index}|">Duration</label>
                             <input type="text" class="form-control" th:id="|expDuration${iterStat.index}|" th:field="*{experiences[__${iterStat.index}__].duration}" placeholder="Jan 2020 - Present">
                         </div>
                        <div class="col-12 mb-3">
                            <label class="form-label" th:for="|expDesc${iterStat.index}|">Description / Responsibilities</label>
                            <textarea class="form-control" rows="3" th:id="|expDesc${iterStat.index}|" th:field="*{experiences[__${iterStat.index}__].description}" placeholder="Describe your role and achievements..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Education -->
        <div class="card mb-4">
             <div class="card-header d-flex justify-content-between align-items-center">
                <span>Step 5: Education</span>
                <button type="button" class="btn btn-light btn-add" onclick="addEducation()">+</button>
            </div>
            <div class="card-body" id="education-container">
                <div th:each="edu, iterStat : *{educations}" class="education-entry mb-4 p-3 border rounded">
                     <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label" th:for="|eduDegree${iterStat.index}|">Degree / Certificate</label>
                            <input type="text" class="form-control" th:id="|eduDegree${iterStat.index}|" th:field="*{educations[__${iterStat.index}__].degree}" placeholder="B.Sc. in Computer Science">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label" th:for="|eduInstitution${iterStat.index}|">Institution</label>
                            <input type="text" class="form-control" th:id="|eduInstitution${iterStat.index}|" th:field="*{educations[__${iterStat.index}__].institution}" placeholder="University of Technology">
                        </div>
                         <div class="col-md-12 mb-3">
                             <label class="form-label" th:for="|eduGradYear${iterStat.index}|">Graduation Year</label>
                             <input type="text" class="form-control" th:id="|eduGradYear${iterStat.index}|" th:field="*{educations[__${iterStat.index}__].gradYear}" placeholder="2019">
                         </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Skills -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>Step 6: Skills</span>
                <button type="button" class="btn btn-light btn-add" onclick="addSkill()">+</button>
            </div>
            <div class="card-body" id="skills-container">
                <div th:each="skill, iterStat : *{skills}" class="mb-2">
                    <label class="form-label d-none" th:for="|skill${iterStat.index}|">Skill</label>
                    <input type="text" class="form-control" th:id="|skill${iterStat.index}|" th:field="*{skills[__${iterStat.index}__]}" placeholder="e.g., Java, Python, Project Management">
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100 download-btn">
            Generate & Download PDF
        </button>
    </form>
</div>

<script>
    let expIndex = document.querySelectorAll('.experience-entry').length;
    let eduIndex = document.querySelectorAll('.education-entry').length;
    let skillIndex = document.querySelectorAll('#skills-container input').length;

    function addExperience() {
        const container = document.getElementById('experience-container');
        const newEntry = `
            <div class="experience-entry mb-4 p-3 border rounded">
                 <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="expJobTitle${expIndex}">Job Title</label>
                        <input type="text" class="form-control" id="expJobTitle${expIndex}" name="experiences[${expIndex}].jobTitle" placeholder="Software Engineer">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="expCompany${expIndex}">Company</label>
                        <input type="text" class="form-control" id="expCompany${expIndex}" name="experiences[${expIndex}].company" placeholder="Tech Solutions Inc.">
                    </div>
                     <div class="col-md-12 mb-3">
                         <label class="form-label" for="expDuration${expIndex}">Duration</label>
                         <input type="text" class="form-control" id="expDuration${expIndex}" name="experiences[${expIndex}].duration" placeholder="Jan 2020 - Present">
                     </div>
                    <div class="col-12 mb-3">
                        <label class="form-label" for="expDesc${expIndex}">Description / Responsibilities</label>
                        <textarea class="form-control" rows="3" id="expDesc${expIndex}" name="experiences[${expIndex}].description" placeholder="Describe your role and achievements..."></textarea>
                    </div>
                </div>
            </div>
        `;
        container.insertAdjacentHTML('beforeend', newEntry);
        expIndex++;
    }

    function addEducation() {
        const container = document.getElementById('education-container');
        const newEntry = `
            <div class="education-entry mb-4 p-3 border rounded">
                 <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="eduDegree${eduIndex}">Degree / Certificate</label>
                        <input type="text" class="form-control" id="eduDegree${eduIndex}" name="educations[${eduIndex}].degree" placeholder="B.Sc. in Computer Science">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="eduInstitution${eduIndex}">Institution</label>
                        <input type="text" class="form-control" id="eduInstitution${eduIndex}" name="educations[${eduIndex}].institution" placeholder="University of Technology">
                    </div>
                     <div class="col-md-12 mb-3">
                         <label class="form-label" for="eduGradYear${eduIndex}">Graduation Year</label>
                         <input type="text" class="form-control" id="eduGradYear${eduIndex}" name="educations[${eduIndex}].gradYear" placeholder="2019">
                     </div>
                </div>
            </div>
        `;
        container.insertAdjacentHTML('beforeend', newEntry);
        eduIndex++;
    }

    function addSkill() {
        const container = document.getElementById('skills-container');
        const newEntry = `
            <div class="mb-2">
                <label class="form-label d-none" for="skill${skillIndex}">Skill</label>
                <input type="text" class="form-control" id="skill${skillIndex}" name="skills[${skillIndex}]" placeholder="e.g., Java, Python, Project Management">
            </div>
        `;
        container.insertAdjacentHTML('beforeend', newEntry);
        skillIndex++;
    }
</script>
</body>
</html>

